<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>—</title>

<script src="site_libs/header-attrs-2.6/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Ciencia de datos</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Instalar R
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="instalar-r.html">Instalar R</a>
    </li>
    <li>
      <a href="instalar-rtools.html">Instalar Rtools</a>
    </li>
    <li>
      <a href="recursos.html">Recursos de R</a>
    </li>
    <li>
      <a href="swirl.html">Aprender R con SWIRL</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lenguaje R
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="recursos.html">Recursos de R</a>
    </li>
    <li>
      <a href="Vectores.html">Vectores</a>
    </li>
    <li>
      <a href="estructuras-de-control.html">Estructuras de control</a>
    </li>
    <li>
      <a href="marcos-de-datos.html">Marcos de datos</a>
    </li>
    <li>
      <a href="marcos-de-datos-con-dplyr.html">Marcos de datos con dplyr</a>
    </li>
    <li>
      <a href="descargar-salvar-recuperar.html">Descargar / Salvar / Recuperar</a>
    </li>
    <li>
      <a href="valores-perdidos.html">Valores perdidos</a>
    </li>
    <li>
      <a href="directorios.html">Listar directorios</a>
    </li>
    <li>
      <a href="expresiones-regulares.html">Expresiones regulares</a>
    </li>
    <li>
      <a href="fechas.html">Fechas</a>
    </li>
    <li>
      <a href="muestras-aleatorias.html">Muestras aleatorias</a>
    </li>
    <li>
      <a href="graficos-ggplot2.html">Gráficos</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Obtener datos
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="leer-hojas-excel.html">Leer hojas Excel</a>
    </li>
    <li>
      <a href="leer-ficheros-xml.html">Leer ficheros XML</a>
    </li>
    <li>
      <a href="leer-ficheros-html.html">Leer ficheros HTML</a>
    </li>
    <li>
      <a href="leer-twitter.html">Leer Twitter</a>
    </li>
    <li>
      <a href="leer-bases-de-datos-sql.html">Leer bases de datos SQL</a>
    </li>
    <li>
      <a href="leer-bases-de-datos-no-sql.html">Leer bases de datos No SQL</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    R Studio
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="paquete-rmarkdown.html">R MarkDown</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Estadística
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="ley-grandes-numeros.html">La ley de los grandes números</a>
    </li>
    <li>
      <a href="estadistica-descriptiva.html">Estadística descriptiva</a>
    </li>
    <li>
      <a href="prueba-t-student.html">La prueba t de Student</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">—</h1>

</div>


<div id="prueba-t-de-student-para-valorar-si-la-media-puede-ser-igual-a-un-valor-dado" class="section level2">
<h2>Prueba t de Student para valorar si la media puede ser igual a un valor dado</h2>
<div id="las-pantallas-de-5-pulgadas-de-churratech" class="section level4">
<h4>Las pantallas de 5 pulgadas de ChurraTech</h4>
<p>ChurraTech, una empresa del Polígono Industrial de Villachurras de Merinas, fabrica, entre otras cosas, pantallas de 5 pulgadas para teléfonos móviles. En los últimos meses, han tenido mas devoluciones que nunca de clientes que afirman que las pantallas no se pueden ajustar de ninguna manera.</p>
<p>ChurraTech necesita estar segura de que el proceso de fabricación de sus pantallas está bien calibrado hacia el tamaño de 5 pulgadas.</p>
<p>En realidad, aunque no pueden saberlo, el tamaño de las 100 mil pantallas que ya tienen fabricadas y empaquetadas sigue una distribución normal de media 5.1 pulgadas y desviación 0.3 pulgadas.</p>
<p>ChurraTech toma una muestra aleatoria, 30 pantallas elegidas al azar entre las que tienen fabricadas, para analizar si realmente tienen un problema o no.</p>
<pre class="r"><code>set.seed(123)
poblacion &lt;- rnorm(100000, mean=5.1, sd=0.3)
muestra &lt;- sample(x=poblacion, size=30)</code></pre>
<p>La media de la muestra (5.09 pulgadas) y el resto de elementos de una estadística descriptiva que hacen de la muestra son preocupantes pero la estadística descriptiva de una muestra nunca es definitiva.</p>
<p>Podemos hacer estimaciones de la verdadera media mediante la <strong>Prueba t de Student</strong> que en R se realiza con la función <strong>t.test</strong>. Pero la prueba sólo es válida si la población de la que se tomó la muestra (las 100 mil pantallas) es “aproximadamente normal”, es decir, si la tabla de distribución de la población es “parecida” a la de la distribución normal de las mismas media y desviación típica.</p>
<p>Ahora bien, no hemos medido toda la población (las 100 mil pantallas). Sólo hemos medido la muestra.</p>
<p>Podemos salir de este problema gracias a que:<br />
* La <strong>prueba t de Student</strong> es muy robusta y vale con que sea <em>no descartable</em> la normalidad de la población.<br />
* Existe la prueba de normalidad de <strong>Shapiro-Wilk</strong> que, trabajando solo con la muestra, valora si es o no descartable la normalidad de la población.</p>
<p>La prueba de Shapiro se realiza en R con la función <strong>shapiro.test</strong>. Esta función devuelve una probabilidad o “p-valor”, entre 0 y 1, que se interpreta como la admisibilidad de que la población sea normal. Se suele descartar la hipótesis de la normalidad si la admisibilidad es de menos del 5%, es decir, si el p-valor queda entre 0 y 0.05.</p>
<pre class="r"><code>shapiro.test(x = muestra)</code></pre>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  muestra
## W = 0.97576, p-value = 0.7052</code></pre>
<pre class="r"><code>p_valor = round( shapiro.test(x = muestra)$p.value  ,2)</code></pre>
<p>Como la prueba de Shapiro devuelve un p-valor de 0.71, la normalidad de la población <em>no es descartable</em> y podemos proceder con la Prueba t de Student.</p>
<p>A la función <strong>t.test</strong> le pasamos los parámetros:</p>
<ul>
<li>x: la muestra aleatoria que hemos tomado de la población</li>
<li>mu: el valor que queremos evaluar como posible media de la población</li>
</ul>
<p>Y <strong>t.test</strong> nos devuelve una probabilidad o “p-valor”, entre 0 y 1, que se interpreta como la “admisibilidad” de que “mu” sea realmente la media de la población. Lo habitual es descartar la hipótesis de que “mu” es la media de la población si la admisibiliad es de menos del 5%, es decir, si el p-valor queda entre 0 y 0.05.</p>
<p>Veamos si es admisible la hipótesis de que el tamaño medio de las pantallas es de 5 pulgadas:</p>
<pre class="r"><code>t.test(x = muestra, mu = 5)</code></pre>
<pre><code>## 
##  One Sample t-test
## 
## data:  muestra
## t = 1.8949, df = 29, p-value = 0.06811
## alternative hypothesis: true mean is not equal to 5
## 95 percent confidence interval:
##  4.992488 5.196953
## sample estimates:
## mean of x 
##   5.09472</code></pre>
<pre class="r"><code>p_valor = round( t.test(x = muestra, mu = 5)$p.value ,2)</code></pre>
<p>Tenemos un p-valor de 0.07 luego <strong>no podemos descartar que el tamaño medio de las pantallas sea de 5 pulgadas</strong>.</p>
<p>Pero no es lo mismo “no poder descartar una hipótesis” que “aceptar la hipótesis”. ¿Deberíamos aceptarla? En general NO, porque la Prueba t de Student sólo sirve para descartar. El p-valor sólo es significativo cuando es muy pequeño porque entonces descartamos la hipótesis. Cuando el p-valor <em>no es muy pequeño</em> decimos que la hipótesis es admisible o no-descartable y ahí acaba la Prueba t de Student.</p>
<p>Para decidirnos a aceptar una hipótesis admisible tenemos que calcular la <strong>potencia de la muestra</strong> y comprobar que hay suficiente potencia.</p>
<p>La “potencia” de la muestra se calcula con la función “power.t.test” que toma los parámetros:</p>
<ul>
<li>type = “one.sample”: esto indica que manejamos una única muestra</li>
<li>n: tamaño de la muestra</li>
<li>delta: escala o unidad de medida que utilizamos; en nuestro caso, 0.1 pulgadas</li>
<li>sd: desviación típica de la muestra</li>
</ul>
<pre class="r"><code>power.t.test(type = &quot;one.sample&quot;, 
             n = length(muestra),
             delta = 0.1,
             sd = sd(muestra))</code></pre>
<pre><code>## 
##      One-sample t test power calculation 
## 
##               n = 30
##           delta = 0.1
##              sd = 0.2737843
##       sig.level = 0.05
##           power = 0.4897046
##     alternative = two.sided</code></pre>
<pre class="r"><code>potencia = round(
  power.t.test(type = &quot;one.sample&quot;, 
             n = length(muestra),
             delta = 0.1,
             sd = sd(muestra))$power, 2)</code></pre>
<p>Resulta que tenemos una muestra con una potencia de 0.49. No hay un criterio universal pero se suele pedir una potencia de al menos 0.8 para admitir una hipótesis admisible. En nuestro caso, por tanto, no tenemos potencia y tan sólo podemos decir lo ya dicho: el tamaño medio de 5 pulgadas no es una hipótesis descartable.</p>
<p>Si queremos obtener una muestra con mas potencia tiene que tener mayor tamaño. No está en nuestra mano incrementar la potencia de otra manera. ¿Qué tamaño? También podemos estimarlo con la misma función “power.t.test” pero sustituyendo el parametro “n” (tamaño de la muestra) por el parámetro:</p>
<ul>
<li>power: potencia requerida para la muestra; vamos a pedir un 85%</li>
</ul>
<p>De esta manera, se estimará el tamaño necesario en función de la potencia deseada:</p>
<pre class="r"><code>power.t.test(type = &quot;one.sample&quot;, 
             power = 0.85,
             delta = 0.1,
             sd = sd(muestra))</code></pre>
<pre><code>## 
##      One-sample t test power calculation 
## 
##               n = 69.24719
##           delta = 0.1
##              sd = 0.2737843
##       sig.level = 0.05
##           power = 0.85
##     alternative = two.sided</code></pre>
<pre class="r"><code>tamano = round(
  power.t.test(type = &quot;one.sample&quot;, 
             power = 0.85,
             delta = 0.1,
             sd = sd(muestra))$n,
  0)</code></pre>
<p>Obtenemos que una nueva muestra aleatoria de 69 pantallas deberia ser suficiente para tener una potencia del 85%. Veamos si es así:</p>
<pre class="r"><code># Muestra aleatoria
muestra &lt;- sample(x=poblacion, size=tamano)
paste(&quot;Media muestral (media de la muestra):&quot;, round(mean(muestra), 2))</code></pre>
<pre><code>## [1] &quot;Media muestral (media de la muestra): 5.11&quot;</code></pre>
<pre class="r"><code>paste(&quot;Error muestral (desviación típica de la muestra):&quot;, round(sd(muestra), 2))</code></pre>
<pre><code>## [1] &quot;Error muestral (desviación típica de la muestra): 0.27&quot;</code></pre>
<pre class="r"><code># Prueba de normalidad de Shapiro
round( shapiro.test(x = muestra)$p.value ,2)  </code></pre>
<pre><code>## [1] 0.2</code></pre>
<pre class="r"><code># p-valor asociado a la hipótesis de que el tamaño medio es 5 pulgadas
round( t.test(x = muestra, mu = 5)$p.value ,3)</code></pre>
<pre><code>## [1] 0.001</code></pre>
<pre class="r"><code># Potencia de la muestra
potencia = round( power.t.test(type = &quot;one.sample&quot;, 
             n = length(muestra),
             delta = 0.1,
             sd = sd(muestra))$power ,2)
potencia</code></pre>
<pre><code>## [1] 0.86</code></pre>
<p>La potencia de la muestra se ha incrementado hasta el 86 por ciento, algo más incluso de lo que pretendíamos. Pero el dato realmente significativo ahora es que tenemos un p-valor prácticamente igual a cero y, entonces, <strong>podemos descartar la hipótesis que el tamaño medio de las pantallas sea de 5 pulgadas</strong>.</p>
<p>En caso de haber resultado admisible la hipótesis del tamaño medio de 5 pulgadas, podríamos haber dicho que la admitimos con una confianza del 86 por ciento.</p>
</div>
</div>
<div id="prueba-t-de-student-para-valorar-si-la-media-puede-ser-menor-o-igual-que-un-valor-dado" class="section level2">
<h2>Prueba t de Student para valorar si la media puede ser menor o igual que un valor dado</h2>
<div id="el-imc-de-villachurras-de-merinas" class="section level4">
<h4>El IMC de Villachurras de Merinas</h4>
<p>El ayuntamiento de Villachurras de Merinas está preocupado por el sobrepeso de sus ciudadanos. Se considera pre-obesidad tener un IMC (indicador que se calcula a partir de la altura y el peso) superior a 27 asi que el Ayuntamiento quisiera poder descartar ese escenario.</p>
<p>No tienen manera de saberlo pero el IMC de los 100 mil habitantes en edad adulta realmente se distribuye según una normal de media 28 y desviación típica 2 así que, realmente, la media supera los 27.</p>
<pre class="r"><code>poblacion &lt;- rnorm(100000, mean=28, sd=2)</code></pre>
<p>El ayuntamiento toma una muestra aleatoria pequeña de la población (30 individuos) para empezar a analizar si realmente puede haber un problema de obesidad o no:</p>
<pre class="r"><code>#Muestra aleatoria
muestra &lt;- sample(x=poblacion, size=30)</code></pre>
<p>La media muestral es 27.7 y el error muestral es 2.05. La media de la muestra es preocupante pero es sólo una muestra así que, de momento, no hay nada definitivo.</p>
<p>Según la prueba de shapiro, la hipótesis de que la población es aproximadamente normal tiene un p-valor de 0.35. Como es superior a 0.05, la hipótesis no es descartable.</p>
<p>Utilizamos la función <strong>t.test</strong> pero tenemos que indicar que la hipotesis cuya admisibilidad queremos evaluar no es que el IMC sea igual a 27 sino menor o igual que 27. Esto se hace añadiendo el parámetro “alternative”, que tiene una sintaxis “peculiar”. En definitiva, a la función “t.test” le pasamos estos parámetros:</p>
<ul>
<li>x: la muestra aleatoria que hemos tomado de la población</li>
<li>mu: el valor que queremos evaluar como posible media de la población</li>
<li><strong>alternative = “greater”</strong>: esto indica que se evalue si la media de la poblacion puede ser “NOT greater” (“NO mayor”, que equivale a “menor o igual”) que mu
<ul>
<li>Nota: para evaluar “mayor o igual que” se utilizaria <em>alternative =“less”</em></li>
</ul></li>
</ul>
<pre class="r"><code>t.test(x = muestra, mu = 27, alternative = &quot;greater&quot;)</code></pre>
<pre><code>## 
##  One Sample t-test
## 
## data:  muestra
## t = 1.8673, df = 29, p-value = 0.036
## alternative hypothesis: true mean is greater than 27
## 95 percent confidence interval:
##  27.06283      Inf
## sample estimates:
## mean of x 
##  27.69754</code></pre>
<pre class="r"><code>p_valor = round( 
  t.test(x = muestra, mu = 27, alternative = &quot;greater&quot;)$p.value 
  ,2)</code></pre>
<p>Por desgracia para el Ayuntamiento, la hipótesis de que el IMC medio es menor o igual que 27 hay que descartarla ya que hemos obtenido un p-valor de 0.04.</p>
<p>Si la hipótesis hubiera sido admisible, tendríamos que haber evaluado la potencia de la muestra para admitirla o no. Como en “t.test” hemos utilizado el parametro “alternative” tenemos que indicarlo en “power.t.test” tambien:</p>
<ul>
<li>type = “one.sample”: esto indica que manejamos una única muestra</li>
<li>n: tamaño de la muestra</li>
<li>delta: escala o unidad de medida que utilizamos; en nuestro caso, 0.25</li>
<li>sd: desviación típica de la muestra</li>
<li>alternative = “one.sided”: indica que en “t.test” se utiliza “less” o “greater”</li>
</ul>
<pre class="r"><code>power.t.test(type = &quot;one.sample&quot;, 
             n = length(muestra),
             delta = 0.25,
             sd = sd(muestra),
             alternative = &quot;one.sided&quot;)</code></pre>
<pre><code>## 
##      One-sample t test power calculation 
## 
##               n = 30
##           delta = 0.25
##              sd = 2.046016
##       sig.level = 0.05
##           power = 0.1608112
##     alternative = one.sided</code></pre>
<pre class="r"><code>potencia = round(
  power.t.test(type = &quot;one.sample&quot;, 
             n = length(muestra),
             delta = 0.25,
             sd = sd(muestra),
             alternative = &quot;one.sided&quot;)$power,
  2)</code></pre>
<p>Con una potencia del 16 por ciento, no hubiéramos podido admitir la hipótesis, en caso de haber sido admisible.</p>
</div>
</div>
<div id="prueba-t-de-student-para-valorar-si-la-media-ha-cambiado-tras-un-periodo-de-tiempo" class="section level2">
<h2>Prueba t de Student para valorar si la media ha cambiado tras un periodo de tiempo</h2>
<div id="dieta-para-los-paisanos-de-villachurras-de-merinas" class="section level4">
<h4>Dieta para los paisanos de Villachurras de Merinas</h4>
<p>Preocupado por tener un IMC medio por encima de 27, el Ayuntamiento de Villachurras de Merinas decide promover un programa de dietas para personas en niveles de preobesidad. Quieren poner a prueba la dieta primero, así que han tomado 30 voluntarios y les han pesado antes y después de seguir la dieta durante 4 semanas.</p>
<pre class="r"><code>antes &lt;- round( rnorm(30, mean = 85, sd = 3) ,1)
despues &lt;- round( antes - rnorm(30, mean = 4, sd = 13) ,1)
diferencia &lt;- antes - despues
head( data.frame(antes, despues) )</code></pre>
<pre><code>##   antes despues
## 1  82.5    71.5
## 2  85.4    86.2
## 3  82.9    68.6
## 4  80.3    84.4
## 5  83.7    84.5
## 6  90.6    94.4</code></pre>
<pre class="r"><code>media_muestral = round(mean(diferencia), 1)
error_muestral = round(sd(diferencia), 1)</code></pre>
<p>La diferencia media entre el peso antes y después de la dieta es prometedora (un descenso de 5.2 kg) pero el error es preocupante (13.3 kg). En cualquier caso, es sólo una muestra.</p>
<p>Utilizaremos la Prueba t de Student para evaluar si es admisible pensar que, en realidad, las medias hubieran sido iguales si hubiéramos realizado el estudio sobre toda la población, sometiéndola a dieta y pesándola antes y después de la dieta. Esto significaría que la dieta carece de utilidad.</p>
<p>Analizamos primero si es admisible pensar que la diferencia entre ambas muestras sigue una distribución normal:</p>
<pre class="r"><code>#Prueba de normalidad de Shapiro
shapiro.test(x = diferencia)</code></pre>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  diferencia
## W = 0.97733, p-value = 0.7509</code></pre>
<pre class="r"><code>p_valor = round( shapiro.test(x = diferencia)$p.value  ,2)</code></pre>
<p>El p-valor es 0.75, luego es admisible.</p>
<p>Ahora utilizamos la función “t.test” con los siguientes parámetros:</p>
<ul>
<li>x: los pesos antes de empezar la dieta</li>
<li>y: los pesos tras cuatro semanas a dieta</li>
<li><strong>paired=TRUE</strong>: esto indica que los individuos están “pareados”, es decir, que son los mismos individuos y sus pesos están registrados en el mismo orden antes y después de la dieta</li>
</ul>
<p>Entonces, “t.test” nos devuelve un p-valor que indica la admisibilidad de que los pesos medios, calculados sobre toda la población, sean iguales:</p>
<pre class="r"><code>t.test(x = antes, y=despues, paired=TRUE)</code></pre>
<pre><code>## 
##  Paired t-test
## 
## data:  antes and despues
## t = 2.1443, df = 29, p-value = 0.04052
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##   0.2409533 10.1857133
## sample estimates:
## mean of the differences 
##                5.213333</code></pre>
<pre class="r"><code>p_valor = round( t.test(x = antes, y=despues, paired=TRUE)$p.value ,2)</code></pre>
<p>Con un p-valor de 0.04, podemos descartar la idea de que los pesos medios calculados sobre toda la población hubieran sido iguales. La dieta es efectiva.</p>
<p>También podríamos haber investigado la admisibilidad de que los pesos medios, calculados sobre toda la población, hubieran sido menores o iguales antes de la dieta. Esto significaría que la dieta no solo es inefectiva sino perjudicial.</p>
<ul>
<li>x: los pesos antes de empezar la dieta</li>
<li>y: los pesos tras cuatro semanas a dieta</li>
<li>paired=TRUE: esto indica que los individuos están “pareados”</li>
<li>alternative = “greater”</li>
</ul>
<pre class="r"><code>p_valor = round( t.test(x = antes, y=despues, 
              paired=TRUE,
              alternative = &quot;greater&quot;)$p.value ,2)</code></pre>
<p>El p-valor es incluso menor (0.02) así que rechazamos esa hipótesis también.</p>
<p>La tercera vía hubiera sido investigar la admisibilidad de que los pesos medios, calculados sobre toda la población, hubieran sido mayores o iguales antes de la dieta. Esto significaría que la dieta es <em>muy</em> efectiva.</p>
<ul>
<li>x: los pesos antes de empezar la dieta</li>
<li>y: los pesos tras cuatro semanas a dieta</li>
<li>paired=TRUE: esto indica que los individuos están “pareados”</li>
<li>alternative = “less”</li>
</ul>
<pre class="r"><code>p_valor = round( t.test(x = antes, y=despues, 
              paired=TRUE,
              alternative = &quot;less&quot;)$p.value ,2)</code></pre>
<p>El p-valor es muy alto (0.98) pero aun así sólo podemos admitir la hipótesis si las muestras tienen una potencia del 80% o más:</p>
<ul>
<li>type = “paired”: esto indica que manejamos dos muestras pero que están pareadas (son los mismos individuos o prácticamente idénticos dos a dos)</li>
<li>n: tamaño de las muestras</li>
<li>delta: escala o unidad de medida que utilizamos; en nuestro caso, 0.1 kg</li>
<li>sd: desviación típica de la diferencia</li>
<li>alternative = “one.sided”: indica que en “t.test” se utiliza “less” o “greater”</li>
</ul>
<pre class="r"><code>power.t.test(type = &quot;paired&quot;, 
             n = length(antes), #podría ser length(despues)
             delta = 0.1,
             sd = sd(diferencia),
             alternative = &quot;one.sided&quot;)</code></pre>
<pre><code>## 
##      Paired t test power calculation 
## 
##               n = 30
##           delta = 0.1
##              sd = 13.31628
##       sig.level = 0.05
##           power = 0.05428315
##     alternative = one.sided
## 
## NOTE: n is number of *pairs*, sd is std.dev. of *differences* within pairs</code></pre>
<pre class="r"><code>potencia = round(
  power.t.test(type = &quot;paired&quot;, 
             n = length(antes), #podría ser length(despues)
             delta = 0.1,
             sd = sd(diferencia),
             alternative = &quot;one.sided&quot;)$power,
  2)</code></pre>
<p>Con una potencia de 0.05 no podemos de ninguna manera admitir la hipótesis. Veamos cuántos voluntarios hubieran sido necesarios para tener potencia suficiente:</p>
<pre class="r"><code>tamano = round(
  power.t.test(type = &quot;paired&quot;, 
             power = 0.80, 
             delta = 0.1,
             sd = sd(diferencia),
             alternative = &quot;one.sided&quot;)$n,
  0)</code></pre>
<p>Tendriamos que haber tenido 109632 voluntarios, algo totalmente inviable ya que ni siquiera hay tantos habitantes adultos en el pueblo.</p>
<p><strong>Se ve con estos ejemplos que siempre es mejor plantear la Prueba t de Student para descartar en lugar de para admitir hipótesis.</strong></p>
</div>
</div>
<div id="prueba-t-de-student-para-valorar-si-la-media-cambia-entre-dos-grupos" class="section level2">
<h2>Prueba t de Student para valorar si la media cambia entre dos grupos</h2>
<div id="descartando-el-efecto-placebo-en-la-dieta-de-los-paisanos-de-villachurras-de-merinas" class="section level4">
<h4>Descartando el efecto placebo en la dieta de los paisanos de Villachurras de Merinas</h4>
<p>La dieta que el Ayuntamiento de Villachurras de Merinas ha puesto a prueba es efectiva, según el estudio realizado con 30 voluntarios durante 4 semanas.</p>
<p>Sin embargo, siempre queda la duda del “efecto placebo”. Por ejemplo, esos 30 voluntarios, viendo que el objetivo era bajar de peso, es posible que se hayan cuidado de manera especial haciendo ejercicio además de la dieta.</p>
<p>Para analizar si el éxito de la dieta se debe a factores externos, se pidieron otros 30 voluntarios similares no sólo en cuanto a peso sino edad, sexo, etc. Se les puso a dieta también, sólo que esta dieta no era tal sino que aportaba una cantidad normal de calorías.</p>
<p>Comparando, podremos ver si ha habido “efecto placebo” o no.</p>
<p>Al grupo que siguió una verdadera dieta se le suele llamar “grupo de tratamiento” y al grupo “engañado” porque su dieta no era tal se le suele llamar “grupo de control”.</p>
<pre class="r"><code>tratamiento_antes &lt;- antes
tratamiento_despues &lt;- despues
tratamiento &lt;- tratamiento_antes - tratamiento_despues

control_antes &lt;- round( rnorm(30, mean = 85, sd = 3) ,1)
control_despues &lt;- round( control_antes - rnorm(30, mean = 0.1, sd = 0.3) ,1)
control &lt;- control_antes - control_despues</code></pre>
<p>Analizamos primero si es admisible pensar que tanto la muestra de tratamiento como la de control siguen una distribución normal. Hacemos, entonces, dos pruebas de normalidad de Shapiro:</p>
<pre class="r"><code>#Prueba de normalidad de Shapiro
round( shapiro.test(x = tratamiento)$p.value  ,2)</code></pre>
<pre><code>## [1] 0.75</code></pre>
<pre class="r"><code>round( shapiro.test(x = control)$p.value  ,2)</code></pre>
<pre><code>## [1] 0.82</code></pre>
<p>Efectivamente, es admisible que ambas muestras siguen una distribución normal.</p>
<p>Ahora podemos utilizar la Prueba t de student para valorar la admisibilidad de que las pérdidas de peso medias hubieran sido iguales si hubiéramos utilizado toda la población tanto en el grupo de tratamiento como en el de control:</p>
<ul>
<li>x: las pérdidas de peso en el grupo de tratamiento</li>
<li>y: las pérdidas de peso en el grupo de control</li>
</ul>
<pre class="r"><code>t.test(x = tratamiento, y=control)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  tratamiento and control
## t = 2.0874, df = 29.038, p-value = 0.04573
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##   0.1029406 10.0503928
## sample estimates:
## mean of x mean of y 
## 5.2133333 0.1366667</code></pre>
<pre class="r"><code>p_valor = round( t.test(x = tratamiento, y=control)$p.value ,3)</code></pre>
<p>Con un p-valor de 0.046, rechazamos la hipótesis.</p>
<p>Valoremos también la admisibilidad de que la pérdida de peso media hubiera sido menor o igual en el grupo de tratamiento si hubiéramos utilizado toda la población tanto en el grupo de tratamiento como en el de control:</p>
<ul>
<li>x: los pesos antes de empezar la dieta</li>
<li>y: los pesos tras cuatro semanas a dieta</li>
<li>alternative = “greater”</li>
</ul>
<pre class="r"><code>p_valor = round( t.test(x = tratamiento, y=control,
              alternative = &quot;greater&quot;)$p.value ,2)</code></pre>
<p>Con un p-valor de 0.02, rechazamos la hipótesis.</p>
<p>Por último, valoremos la admisibilidad de que la pérdida de peso media hubiera sido mayor o igual en el grupo de tratamiento si hubiéramos utilizado toda la población tanto en el grupo de tratamiento como en el de control:</p>
<ul>
<li>x: los pesos antes de empezar la dieta</li>
<li>y: los pesos tras cuatro semanas a dieta</li>
<li>alternative = “less”</li>
</ul>
<pre class="r"><code>p_valor = round( t.test(x = tratamiento, y=control,
              alternative = &quot;less&quot;)$p.value ,2)</code></pre>
<p>El p_valor es 0.98 así que es admisible pero sólo podemos admitir la hipótesis si las muestras tienen potencia suficiente:</p>
<ul>
<li>type = “two.sample”: esto indica que manejamos dos muestras y que NO están pareadas (no son los mismos individuos ni son prácticamente idénticos dos a dos)</li>
<li>n: tamaño de las muestras</li>
<li>delta: escala o unidad de medida que utilizamos; en nuestro caso, 0.1 kg</li>
<li>sd: desviación típica de la diferencia</li>
<li>alternative = “one.sided”: indica que en “t.test” se utiliza “less” o “greater”</li>
</ul>
<pre class="r"><code>power.t.test(type = &quot;two.sample&quot;, 
             n = length(tratamiento), #podría ser length(control)
             delta = 0.1,
             sd = sd(tratamiento - control),
             alternative = &quot;one.sided&quot;)</code></pre>
<pre><code>## 
##      Two-sample t test power calculation 
## 
##               n = 30
##           delta = 0.1
##              sd = 13.29801
##       sig.level = 0.05
##           power = 0.05303992
##     alternative = one.sided
## 
## NOTE: n is number in *each* group</code></pre>
<pre class="r"><code>potencia = round( power.t.test(type = &quot;two.sample&quot;, 
             n = length(tratamiento), #podría ser length(control)
             delta = 0.1,
             sd = sd(tratamiento - control),
             alternative = &quot;one.sided&quot;)$power ,2)</code></pre>
<p>La potencia es de 0.05, muy pequeña. No podemos admitir la hipótesis pero estimemos el tamaño que tendrían que haber tenido las muestras para una potencia del 80%:</p>
<pre class="r"><code>tamano = round( power.t.test(type = &quot;two.sample&quot;, 
             power = 0.80,
             delta = 0.1,
             sd = sd(tratamiento - control),
             alternative = &quot;one.sided&quot;)$n ,0)</code></pre>
<p>Tendriamos que haber tenido 218662 individuos tanto en el grupo de tratamiento como en el de control. La inviabilidad no es sólo de costes sino que esa cifra supera la población total de VillaChurras de Merinas.</p>
<p><strong>Se vuelve a ver con estos ejemplos que siempre es mejor plantear la Prueba t de Student para descartar en lugar de para admitir hipótesis.</strong></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
